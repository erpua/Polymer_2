<link rel="import" href="../../bower_components/polymer/polymer-element.html" />
<link
  rel="import"
  href="../../bower_components/polymer/lib/mixins/gesture-event-listeners.html"
/>
<link rel="import" href="./survey-questions.html" />
<link rel="import" href="./survey-timer.html" />

<dom-module id="survey-element">
  <template>
    <style>
      :host {
        display: block;
      }

      survey-timer {
        user-select: none;
        position: relative;
      }
    </style>

    <!--  <survey-timer id="timer" on-finish-timer="cancelSurvey" on-track="drag">
    </survey-timer>

    <template is="dom-if" if="{{!cancelled}}">
      <survey-questions question="{{question}}"></survey-questions>
    </template>

    <template is="dom-if" if="{{cancelled}}">
      <p>Drag the timer to reset</p>
    </template> -->

    <survey-questions question="{{question}}"></survey-questions>

    <p>Drag the timer to reset</p>
  </template>

  <script>
    class SurveyElement extends Polymer.Element {
      static get is() {
        return 'survey-element';
      }

      static get properties() {
        return {
          cancelled: {
            type: Boolean,
            value: true,
          },
          question: {
            type: Object,
            value: {
              question: 'Do you like Polymer 2?',
              options: ['Yes', 'No', 'Did not figure out yet'],
            },
          },
        };
      }

      cancelSurvey() {
        this.cancelled = true;
      }

      drag(e) {
        //console.log(e);
        if (!this.cancelled) {
          return 0;
        }
        if (e.detail.state == 'end') {
          this.$.timer.style.left = '0px';
          console.log('lo he puesto al final');
          if (e.detail.dx >= 50) {
            this.cancelled = false;
            this.$.timer.reset();
          }
        } else {
          console.log(e.detail.dx);
          this.$.timer.style.left = e.detail.dx + 'px';
        }
      }

      /**
       * Instance of the element is created/upgraded. Use: initializing state,
       * set up event listeners, create shadow dom.
       * @constructor
       */
      constructor() {
        super();
      }
    }

    window.customElements.define(SurveyElement.is, SurveyElement);
  </script>
</dom-module>
